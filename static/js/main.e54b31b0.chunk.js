(this.webpackJsonpsad=this.webpackJsonpsad||[]).push([[0],{170:function(t,e,c){},171:function(t,e,c){"use strict";c.r(e);var n=c(0),r=c(29),a=c.n(r),s=c(4),i=c(18),u=c.n(i),o=c(31),d=c(16),l=c(3),j=c(13),b=c.n(j),m=c(69),h=c.n(m),p=c(1),f=function(t){var e=t.content,c=t.children;return Object(p.jsxs)("div",{className:"badge",children:[c,Object(p.jsx)("span",{className:"badge-content",children:e})]})},O=c.p+"static/media/shopping-basket.7340c518.svg",x=Object.freeze({product:"/",cart:"/cart"}),v=function(){var t=Object(s.c)((function(t){return t.cart.reduce((function(t,e){return t+e.counter}),0)}));return Object(p.jsx)("header",{className:"shop-header",children:Object(p.jsxs)("div",{className:"shop-header__wrapper container-95",children:[Object(p.jsx)("p",{className:"shop-header__text",children:"\u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442 \u043c\u0430\u0433\u0430\u0437\u0438\u043d"}),Object(p.jsx)(d.b,{to:x.cart,children:Object(p.jsx)(f,{content:t,children:Object(p.jsx)("img",{src:O,width:"40",height:"40",alt:"Cart"})})})]})})},g=c(17),_="https://murmuring-tor-81614.herokuapp.com/api",N=function(t){return Array.isArray(t)?t.reduce((function(t,e){return t+e}),_):_+t},y=function(t){var e=_.lastIndexOf("/");return _.slice(0,e)+t},k=Object(g.b)({name:"product",initialState:{loading:!1,error:{},products:[]},reducers:{fetchProductRequested:function(t){t.loading=!0},fetchProductSuccess:function(t,e){t.loading=!1,t.products=e.payload},fetchProductFailure:function(t,e){t.error=e.payload,t.error=!1}}}),C=k.actions,P=c(19),w=Object(g.b)({name:"cart",initialState:[],reducers:{addProduct:function(t,e){var c=t.findIndex((function(t){return t.name===e.payload.name}));c>=0?t[c].counter++:t.push(Object(P.a)(Object(P.a)({},e.payload),{},{counter:1}))},removeProduct:function(t,e){var c=t.findIndex((function(t){return t.name===e.payload.name}));if(t[c].counter<=1)return t.filter((function(t){return t.name!==e.payload.name}));t[c].counter--},setCart:function(t,e){return e.payload},updateProduct:function(t,e){var c=t.findIndex((function(t){return t.name===e.payload.name}));t[c]=e.payload},removeProductFully:function(t,e){return t.filter((function(t){return t.name!==e.payload.name}))},clearAll:function(){return[]}}}),S=w.actions,A=c.p+"static/media/add.c6f2e133.svg",I=c.p+"static/media/minus.7aa3be90.svg",F=function(t){var e=t.handleClickAdd,c=t.handleClickRemove,n=t.value,r=t.className,a=t.disabled,s=t.handleChange;return Object(p.jsxs)("div",{className:"amount ".concat(r),children:[Object(p.jsx)("button",{type:"button",onClick:c,className:"amount-button",children:Object(p.jsx)("img",{src:I,width:"20",height:"20",alt:"Plus",className:"amount-image"})}),Object(p.jsx)("input",{type:"text",className:"amount-value",disabled:a,value:n,min:1,maxLength:3,onChange:function(t){s(t.target.value)}}),Object(p.jsx)("button",{type:"button",onClick:e,className:"amount-button",children:Object(p.jsx)("img",{src:A,width:"20",height:"20",alt:"Minus",className:"amount-image"})})]})},R=function(t){var e=t.product,c=Object(s.c)((function(t){return t.cart.find((function(t){return e.name===t.name}))})),n=Object(s.b)(),r=function(){n(S.addProduct(e))};return Object(p.jsxs)("li",{className:"product__item",children:[Object(p.jsx)("img",{src:y(e.image),alt:e.name,className:"product__item-img",width:"200",height:"200"}),Object(p.jsx)("p",{className:"product__item-name",children:e.name}),Object(p.jsxs)("p",{className:"product__item-price",children:[e.price," $"]}),c?Object(p.jsx)(F,{value:c.counter,handleClickAdd:r,handleClickRemove:function(){n(S.removeProduct(e))},disabled:!0}):Object(p.jsx)("button",{className:"product__item-button",type:"button",onClick:r,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443"})]})},J=function(t){var e=t.products;return Object(p.jsx)("ul",{className:"product__list",children:e.map((function(t){return Object(p.jsx)(R,{product:t},t.name)}))})},E=Object(n.createContext)([]),$=function(){return Object(n.useContext)(E)},q=function(){var t=$().dealers,e=Object(s.c)((function(t){return t.product})),c=Object(s.b)();return Object(n.useEffect)((function(){c(function(t){return function(){var e=Object(o.a)(u.a.mark((function e(c){var n,r,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(C.fetchProductRequested()),n=b()(t)?N("/goods"):N(["/goods","/?dealers=".concat(t.join(","))]),e.prev=2,e.next=5,fetch(n);case 5:return r=e.sent,e.next=8,r.json();case 8:a=e.sent,c(C.fetchProductSuccess(a)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),c(C.fetchProductFailure(e.t0));case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(t){return e.apply(this,arguments)}}()}(t))}),[]),Object(p.jsx)("section",{className:"product container-95",children:!b()(e.products)&&b()(e.error)&&Object(p.jsx)(J,{products:e.products})})},B=function(t){var e=t.className,c=Object(l.f)(),n=["button-back",e];return Object(p.jsx)("button",{type:"button",className:n.join(" "),onClick:c.goBack,children:"\u041d\u0430\u0437\u0430\u0434"})},L=function(){var t=Object(s.b)(),e=Object(l.f)(),c=Object(s.c)((function(t){return t.cart.reduce((function(t,e){return t+e.counter*e.price}),0)}));return Object(p.jsxs)("div",{className:"cart__info",children:[Object(p.jsxs)("p",{className:"cart__info-price",children:["\u041a \u043e\u043f\u043b\u0430\u0442\u0435 :",Object(p.jsxs)("span",{children:[c.toFixed(2),"$"]})]}),Object(p.jsx)("button",{type:"button",className:"cart__info-button",onClick:function(){setTimeout((function(){t(S.clearAll()),e.push(x.product)}),500)},children:"\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})]})},M=function(t){var e=t.height,c=void 0===e?30:e,n=t.width,r=void 0===n?30:n,a=t.className,s=t.handleClick;return Object(p.jsx)("button",{type:"button",className:"button-close ".concat(a),onClick:s,children:Object(p.jsx)("img",{height:c,width:r,src:A,alt:"Remove"})})},z=function(t){var e=t.product,c=Object(s.b)();return Object(p.jsxs)("li",{className:"cart__list-item",children:[Object(p.jsxs)("div",{className:"cart__item-left",children:[Object(p.jsx)("img",{src:y(e.image),alt:e.name,className:"cart__item-img",width:"75",height:"75"}),Object(p.jsxs)("p",{className:"cart__item-name",children:[" ",e.name]})]}),Object(p.jsxs)("div",{className:"cart__item-right",children:[Object(p.jsx)(F,{className:"h-50",value:e.counter,handleClickAdd:function(){c(S.addProduct(e))},handleClickRemove:function(){c(S.removeProduct(e))},handleChange:function(t){t<1e3&&c(S.updateProduct(Object(P.a)(Object(P.a)({},e),{},{counter:+t})))}}),Object(p.jsxs)("p",{className:"cart__item-price",children:[e.price," $"]}),Object(p.jsx)("div",{children:Object(p.jsx)(M,{className:"cart__item-button-close",handleClick:function(){c(S.removeProductFully(e))}})})]})]})},T=function(){var t=Object(s.c)((function(t){return t.cart}));return Object(p.jsx)("ul",{className:"cart__list",children:t.map((function(t){return Object(p.jsx)(z,{product:t},t.name)}))})},D=function(){var t=Object(s.c)((function(t){return t.cart}));return Object(p.jsxs)("section",{className:"cart container-95",children:[Object(p.jsx)(B,{}),Object(p.jsx)("h2",{className:"cart__title",children:"\u0421\u043e\u0434\u0435\u0440\u0436\u0430\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"}),t.length>0?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(T,{}),Object(p.jsx)(L,{})]}):Object(p.jsx)("p",{children:"\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430"})]})};var G=function(){var t=Object(s.b)(),e=$().dealers,c=function(){var c=Object(o.a)(u.a.mark((function c(){var n,r,a,s;return u.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(!((n=JSON.parse(localStorage.getItem("cart")))&&n.length>0)){c.next=13;break}if(b()(e)){c.next=12;break}return c.next=5,fetch(N(["/goods","/?dealers=".concat(e.join(","))]));case 5:return r=c.sent,c.next=8,r.json();case 8:return a=c.sent,s=h()(n,a,"name"),t(S.setCart(s)),c.abrupt("return");case 12:t(S.setCart(n));case 13:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return Object(n.useLayoutEffect)((function(){c()}),[]),Object(p.jsxs)(d.a,{children:[Object(p.jsx)(v,{}),Object(p.jsxs)(l.c,{children:[Object(p.jsx)(l.a,{path:x.product,component:q,exact:!0}),Object(p.jsx)(l.a,{path:x.cart,component:D,exact:!0})]})]})},H=c(9),K=c(22),Q=Object(g.a)({reducer:Object(H.b)({product:k.reducer,cart:w.reducer}),middleware:[K.a,function(t){return function(e){return function(c){var n=e(c);return n.type.includes("cart/")&&localStorage.setItem("cart",JSON.stringify(t.getState().cart)),n}}}]});c(170);window.app={startApp:function(t){a.a.render(Object(p.jsx)(E.Provider,{value:t,children:Object(p.jsx)(n.StrictMode,{children:Object(p.jsx)(s.a,{store:Q,children:Object(p.jsx)(G,{})})})}),document.getElementById("root"))}}}},[[171,1,2]]]);
//# sourceMappingURL=main.e54b31b0.chunk.js.map